"use strict";var ganttChart=function(t){function e(t){var e=Z.call(t);return e!==P&&e!==O&&E("Expected object or array. Got: "+e),e===P?j.items=j.items.concat(t):j.items.push(t),m(),L}function n(t){return arguments.length?(d3.select(window).on("resize",t!==!1?b:null),j.isAutoResize=t,L):j.isAutoResize}function a(){var t=j.lanes.length,e=o(),n=c();G=d3.select(j.renderTo).append("svg").attr("width",j.width).attr("height",j.height).attr("class","gantt-chart"),G.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",e).attr("height",n),z=G.append("g").attr("transform","translate("+j.margin.left+","+j.margin.top+")").attr("width",e).attr("height",n).attr("class","main"),A=z.append("g").attr("clip-path","url(#clip)"),I=d3.select("body").append("div").attr("class","gantt-tooltip").style("opacity",0),N=d3.time.scale().domain(u()).range([0,e]),R=d3.scale.linear().domain([0,t]).range([0,n]),k=d3.svg.axis().scale(N).orient("bottom").ticks(5),Y=d3.svg.axis().scale(R).orient("left").ticks(t).tickFormat(""),X=d3.behavior.zoom().x(N),z.append("g").attr("transform","translate(0,"+n+")").attr("class","main axis date").call(k),z.append("g").attr("class","main axis lane").call(Y),z.append("g").attr("class","laneLabels"),G.call(X),d3.select("html").on("click",function(t){j.isEnableTooltip&&(event.target.closest("svg rect")||h())})}function r(t,e){var n;for(n in e)t.hasOwnProperty(n)&&(Z.call(e[n])===O?r(t[n],e[n]):t[n]=e[n])}function i(t){return arguments.length?(j.isEnableTooltip=t,f(),L):j.isEnableTooltip}function l(t){return arguments.length?(X.on("zoom",t?f:null),j.isEnableZoom=t,L):j.isEnableZoom}function s(){return d3.max(j.items,function(t){return t.lane})+1||0}function o(){return j.width-j.margin.right-j.margin.left}function c(){return j.height-j.margin.top-j.margin.bottom}function u(){return[d3.min(j.items,function(t){return t.start}),d3.max(j.items,function(t){return t.end})]}function h(){I.transition().duration(500).style("opacity",0).style("display","none")}function d(t){var e=Z.call(t);return arguments.length?(e!==P&&E("Expected array. Got: "+e),j.items=t,m(),L):j.items}function g(t){var e=Z.call(t);return arguments.length?(e!==P&&E("Expected array. Got: "+e),j.lanes=t,j.lanes.length=s()||j.lanes.length,w(!j.isShowLaneLabel),w(!j.isShowLaneLabel),L):j.lanes}function p(t){var e=" margin value is incorrect. All values should be numbers";return arguments.length?(void 0!==t.top&&(isNaN(t.top)&&E("'Top'"+e),j.margin.top=parseInt(t.top),z.attr("transform","translate("+j.margin.left+","+j.margin.top+")")),void 0!==t.right&&(isNaN(t.right)&&E("'Right'"+e),j.margin.right=parseInt(t.right)),void 0!==t.bottom&&(isNaN(t.bottom)&&E("'Bottom'"+e),j.margin.bottom=parseInt(t.bottom)),void 0!==t.left&&(isNaN(t.left)&&E("'Left'"+e),j.margin.left=parseInt(t.left),z.attr("transform","translate("+j.margin.left+","+j.margin.top+")")),b(),L):j.margin}function m(){var t=s();j.lanes.length=t,N.domain(u()),Y.ticks(t),R.domain([0,t]),X.x(N),f()}function f(){var t,e=c()/(j.lanes.length||1)/(j.sublanes||1);t=A.selectAll("rect").data(j.items,function(t){return t.id}).attr("x",function(t){return N(t.start)}).attr("y",function(t){return j.sublanes<2?R(t.lane):R(t.lane)+t.sublane*e}).attr("width",function(t){return N(t.end)-N(t.start)}).attr("height",function(t){return e}).on("click",j.isEnableTooltip?x:null),t.enter().append("rect").attr("class",function(t){return t["class"]+" main"}).attr("x",function(t){return N(t.start)}).attr("y",function(t){return j.sublanes<2?R(t.lane):R(t.lane)+t.sublane*e}).attr("width",function(t){return N(t.end)-N(t.start)}).attr("height",function(t){return e}).attr("opacity",.75).on("click",j.isEnableTooltip?x:null),t.exit().remove(),z.select("g.main.axis.date").call(k),z.select("g.main.axis.lane").call(Y),h()}function b(){j.isAutoResize&&(j.width=parseInt(d3.select(j.renderTo).style("width")),j.height=parseInt(d3.select(j.renderTo).style("height")));var t=o(),e=c();N.range([0,t]),R.range([0,e]),G.attr("width",j.width),G.attr("height",j.height),G.select("defs").select("clipPath").select("rect").attr("width",t),G.select("defs").select("clipPath").select("rect").attr("height",t),z.attr("width",t),z.attr("height",e),z.select("g.main.axis.date").attr("transform","translate(0,"+c()+")"),z.select("g.laneLabels").selectAll(".laneText").data(j.lanes).attr("y",function(t,e){return R(e+.5)}),X.x(N),y(j.isShowYGrid),v(j.isShowYGrid),f()}function w(t){return arguments.length?(j.isShowLaneLabel=t,t===!1?z.selectAll(".laneText").remove():z.select("g.laneLabels").selectAll(".laneText").data(j.lanes).enter().append("text").text(function(t){return t}).attr("x",-j.margin.right).attr("y",function(t,e){return R(e+.5)}).attr("dy",".5ex").attr("text-anchor","start").attr("class","laneText"),L):j.isShowLaneLabel}function x(t){I.style("display","block").transition().duration(200).style("opacity",.9),I.html("function"==typeof t.tooltip?t.tooltip():t.tooltip).style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px")}function y(t){if(!arguments.length)return j.isShowXGrid;var e=t!==!1?-c():-6;return k.tickSize(e,0,0),j.isShowXGrid=t,z.select("g.main.axis.date").call(k),L}function v(t){if(!arguments.length)return j.isShowYGrid;var e=t!==!1?-o():-6;return Y.tickSize(e,0,0),j.isShowYGrid=t,z.select("g.main.axis.lane").call(Y),L}function T(t,e){return arguments.length?(j.width=parseInt(t)||j.width,j.height=parseInt(e)||j.height,n(!1),b(),L):[j.width,j.height]}function S(t){return arguments.length?(j.sublanes=t,f(),L):j.sublanes}function E(t){throw TypeError(t)}var L,G,z,A,I,k,N,Y,R,X,j={},Z=Object.prototype.toString,P="[object Array]",O="[object Object]";return L={addItems:e,autoresize:n,enableTooltip:i,enableZoom:l,chart:function(){return z},items:d,lanes:g,margin:p,showLaneLabel:w,showXGrid:y,showYGrid:v,size:T,sublanes:S,svg:function(){return G},redraw:f,renderTo:function(){return j.renderTo},resize:b,xAxis:function(){return k},xScale:function(){return N},yScale:function(){return R},yAxis:function(){return Y},zoom:function(){return X}},j.items=null,j.lanes=null,j.renderTo="#gantt_chart",j.sublanes=1,j.isAutoResize=!0,j.isEnableTooltip=!0,j.isEnableZoom=!0,j.isShowXGrid=!0,j.isShowYGrid=!0,j.isShowLaneLabel=!0,j.height=null,j.width=null,j.margin={top:20,right:15,bottom:20,left:20},function(){r(j,t),j.items=j.items||[],j.lanes=j.lanes||[],j.lanes.length=s(),null===j.height&&(j.height=parseInt(d3.select(j.renderTo).style("height"))||480),null===j.width&&(j.width=parseInt(d3.select(j.renderTo).style("width"))||640),a(),l(j.isEnableZoom),n(j.isAutoResize),i(j.isEnableTooltip),w(j.isEnableTooltip),y(j.isShowXGrid),v(j.isShowYGrid),f()}(),L};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdhbnR0LWNoYXJ0LmpzIl0sIm5hbWVzIjpbImdhbnR0Q2hhcnQiLCJjb25mIiwiYWRkSXRlbXMiLCJuZXdJdGVtcyIsIml0ZW1zVHlwZSIsInRvU3RyIiwiY2FsbCIsImFzdHIiLCJvc3RyIiwidGhyb3dFcnJvciIsInNlbGYiLCJpdGVtcyIsImNvbmNhdCIsInB1c2giLCJvbkl0ZW1zQ2hhbmdlIiwiYXBpIiwiYXV0b3Jlc2l6ZSIsImlzQXV0b1Jlc2l6ZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsImQzIiwic2VsZWN0Iiwid2luZG93Iiwib24iLCJyZXNpemUiLCJidWlsZCIsImxhbmVMZW5ndGgiLCJsYW5lcyIsIm1hcmdpbldpZHRoIiwiZ2V0TWFyZ2luV2lkdGgiLCJtYXJnaW5IZWlnaHQiLCJnZXRNYXJnaW5IZWlnaHQiLCJjaGFydCIsInJlbmRlclRvIiwiYXBwZW5kIiwiYXR0ciIsIndpZHRoIiwiaGVpZ2h0IiwibWFpbiIsIm1hcmdpbiIsImxlZnQiLCJ0b3AiLCJpdGVtUmVjdHMiLCJ0b29sdGlwRGl2Iiwic3R5bGUiLCJ4U2NhbGUiLCJ0aW1lIiwic2NhbGUiLCJkb21haW4iLCJnZXRUaW1lRG9tYWluIiwicmFuZ2UiLCJ5U2NhbGUiLCJsaW5lYXIiLCJ4QXhpcyIsInN2ZyIsImF4aXMiLCJvcmllbnQiLCJ0aWNrcyIsInlBeGlzIiwidGlja0Zvcm1hdCIsInpvb20iLCJiZWhhdmlvciIsIngiLCJkIiwiaXNFbmFibGVUb29sdGlwIiwiZXZlbnQiLCJ0YXJnZXQiLCJjbG9zZXN0IiwiaGlkZVRvb2x0aXAiLCJjb3B5U2FtZVByb3AiLCJjb3B5VG8iLCJjb3B5RnJvbSIsInAiLCJoYXNPd25Qcm9wZXJ0eSIsImVuYWJsZVRvb2x0aXAiLCJyZWRyYXciLCJlbmFibGVab29tIiwiaXNFbmFibGVab29tIiwiZ2V0TGFuZUxlbmd0aCIsIm1heCIsImxhbmUiLCJyaWdodCIsImJvdHRvbSIsIm1pbiIsInN0YXJ0IiwiZW5kIiwidHJhbnNpdGlvbiIsImR1cmF0aW9uIiwibmV3TGFuZXMiLCJsYW5lc1R5cGUiLCJzaG93TGFuZUxhYmVsIiwiaXNTaG93TGFuZUxhYmVsIiwibmV3TWFyZ2luIiwibXNnIiwidW5kZWZpbmVkIiwiaXNOYU4iLCJwYXJzZUludCIsInJlY3RzIiwiaXRlbUhlaWdodCIsInN1YmxhbmVzIiwic2VsZWN0QWxsIiwiZGF0YSIsImlkIiwic3VibGFuZSIsInNob3dUb29sdGlwIiwiZW50ZXIiLCJleGl0IiwicmVtb3ZlIiwiaSIsInNob3dYR3JpZCIsImlzU2hvd1lHcmlkIiwic2hvd1lHcmlkIiwidGV4dCIsImh0bWwiLCJ0b29sdGlwIiwiaXNTaG93WEdyaWQiLCJ0aWNrU2l6ZSIsInNpemUiLCJuZXdTdWJsYW5lcyIsIlR5cGVFcnJvciIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLElBQUlBLFlBQWEsU0FBU0MsR0EwRXRCLFFBQVNDLEdBQVNDLEdBQ2QsR0FBSUMsR0FBWUMsRUFBTUMsS0FBS0gsRUFJM0IsT0FISUMsS0FBY0csR0FBUUgsSUFBY0ksR0FBTUMsRUFBVyxrQ0FBb0NMLEdBQzVGQSxJQUFjRyxFQUFRRyxFQUFLQyxNQUFRRCxFQUFLQyxNQUFNQyxPQUFPVCxHQUFZTyxFQUFLQyxNQUFNRSxLQUFLVixHQUNsRlcsSUFDT0MsRUFHWCxRQUFTQyxHQUFXQyxHQUNoQixNQUFLQyxXQUFVQyxRQUNmQyxHQUFHQyxPQUFPQyxRQUFRQyxHQUFHLFNBQVdOLEtBQWlCLEVBQVNPLEVBQVMsTUFDbkVkLEVBQUtPLGFBQWVBLEVBQ2JGLEdBSHVCTCxFQUFLTyxhQU12QyxRQUFTUSxLQUNMLEdBQUlDLEdBQWFoQixFQUFLaUIsTUFBTVIsT0FDeEJTLEVBQWNDLElBQ2RDLEVBQWVDLEdBRW5CQyxHQUFRWixHQUFHQyxPQUFPWCxFQUFLdUIsVUFDbEJDLE9BQU8sT0FDUEMsS0FBSyxRQUFTekIsRUFBSzBCLE9BQ25CRCxLQUFLLFNBQVV6QixFQUFLMkIsUUFDcEJGLEtBQUss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QUFRLEtBQ2JELEVBQUtpQixNQUFRLEtBQ2JqQixFQUFLdUIsU0FBVyxlQUNoQnZCLEVBQUt5RixTQUFXLEVBRWhCekYsRUFBS08sY0FBZSxFQUNwQlAsRUFBS3NELGlCQUFrQixFQUN2QnRELEVBQUttRSxjQUFlLEVBQ3BCbkUsRUFBS3lHLGFBQWMsRUFDbkJ6RyxFQUFLb0csYUFBYyxFQUNuQnBHLEVBQUtpRixpQkFBa0IsRUFFdkJqRixFQUFLMkIsT0FBUyxLQUNkM0IsRUFBSzBCLE1BQVEsS0FDYjFCLEVBQUs2QixRQUNERSxJQUFLLEdBQ0x3QyxNQUFPLEdBQ1BDLE9BQVEsR0FDUjFDLEtBQU0sSUFHVixXQUNJNkIsRUFBYTNELEVBQU1ULEdBRW5CUyxFQUFLQyxNQUFRRCxFQUFLQyxVQUNsQkQsRUFBS2lCLE1BQVFqQixFQUFLaUIsVUFDbEJqQixFQUFLaUIsTUFBTVIsT0FBUzJELElBRUEsT0FBaEJwRSxFQUFLMkIsU0FBaUIzQixFQUFLMkIsT0FBUzJELFNBQVM1RSxHQUFHQyxPQUFPWCxFQUFLdUIsVUFBVVcsTUFBTSxZQUFjLEtBQzNFLE9BQWZsQyxFQUFLMEIsUUFBZ0IxQixFQUFLMEIsTUFBUTRELFNBQVM1RSxHQUFHQyxPQUFPWCxFQUFLdUIsVUFBVVcsTUFBTSxXQUFhLEtBRTNGbkIsSUFDQW1ELEVBQVdsRSxFQUFLbUUsY0FDaEI3RCxFQUFXTixFQUFLTyxjQUNoQnlELEVBQWNoRSxFQUFLc0QsaUJBQ25CMEIsRUFBY2hGLEVBQUtzRCxpQkFDbkI2QyxFQUFVbkcsRUFBS3lHLGFBQ2ZKLEVBQVVyRyxFQUFLb0csYUFDZm5DLE9Ba1ZHNUQiLCJmaWxlIjoiZ2FudHQtY2hhcnQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2FudHRDaGFydCA9IGZ1bmN0aW9uKGNvbmYpIHtcbiAgICB2YXIgYXBpLFxuICAgICAgICBzZWxmID0ge30sXG4gICAgICAgIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcbiAgICAgICAgYXN0ciA9IFwiW29iamVjdCBBcnJheV1cIixcbiAgICAgICAgb3N0ciA9IFwiW29iamVjdCBPYmplY3RdXCIsXG4gICAgICAgIGNoYXJ0LCBtYWluLCBpdGVtUmVjdHMsIHRvb2x0aXBEaXYsIHhBeGlzLCB4U2NhbGUsIHlBeGlzLCB5U2NhbGUsIHpvb207XG5cbiAgICBhcGkgPSB7XG4gICAgICAgIGFkZEl0ZW1zOiBhZGRJdGVtcyxcbiAgICAgICAgYXV0b3Jlc2l6ZTogYXV0b3Jlc2l6ZSxcbiAgICAgICAgZW5hYmxlVG9vbHRpcDogZW5hYmxlVG9vbHRpcCxcbiAgICAgICAgZW5hYmxlWm9vbTogZW5hYmxlWm9vbSxcbiAgICAgICAgY2hhcnQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbWFpbiB9LFxuICAgICAgICBpdGVtczogaXRlbXMsXG4gICAgICAgIGxhbmVzOiBsYW5lcyxcbiAgICAgICAgbWFyZ2luOiBtYXJnaW4sXG4gICAgICAgIHNob3dMYW5lTGFiZWw6IHNob3dMYW5lTGFiZWwsXG4gICAgICAgIHNob3dYR3JpZDogc2hvd1hHcmlkLFxuICAgICAgICBzaG93WUdyaWQ6IHNob3dZR3JpZCxcbiAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgc3VibGFuZXM6IHN1YmxhbmVzLFxuICAgICAgICBzdmc6IGZ1bmN0aW9uKCkgeyByZXR1cm4gY2hhcnQgfSxcbiAgICAgICAgcmVkcmF3OiByZWRyYXcsXG4gICAgICAgIHJlbmRlclRvOiBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGYucmVuZGVyVG8gfSxcbiAgICAgICAgcmVzaXplOiByZXNpemUsXG4gICAgICAgIHhBeGlzOiBmdW5jdGlvbigpIHsgcmV0dXJuIHhBeGlzIH0sXG4gICAgICAgIHhTY2FsZTogZnVuY3Rpb24oKSB7IHJldHVybiB4U2NhbGUgfSxcbiAgICAgICAgeVNjYWxlOiBmdW5jdGlvbigpIHsgcmV0dXJuIHlTY2FsZSB9LFxuICAgICAgICB5QXhpczogZnVuY3Rpb24oKSB7IHJldHVybiB5QXhpcyB9LFxuICAgICAgICB6b29tOiBmdW5jdGlvbigpIHsgcmV0dXJuIHpvb20gfSxcbiAgICB9O1xuXG4gICAgc2VsZi5pdGVtcyA9IG51bGw7XG4gICAgc2VsZi5sYW5lcyA9IG51bGw7XG4gICAgc2VsZi5yZW5kZXJUbyA9ICcjZ2FudHRfY2hhcnQnO1xuICAgIHNlbGYuc3VibGFuZXMgPSAxO1xuXG4gICAgc2VsZi5pc0F1dG9SZXNpemUgPSB0cnVlO1xuICAgIHNlbGYuaXNFbmFibGVUb29sdGlwID0gdHJ1ZTtcbiAgICBzZWxmLmlzRW5hYmxlWm9vbSA9IHRydWU7XG4gICAgc2VsZi5pc1Nob3dYR3JpZCA9IHRydWU7XG4gICAgc2VsZi5pc1Nob3dZR3JpZCA9IHRydWU7XG4gICAgc2VsZi5pc1Nob3dMYW5lTGFiZWwgPSB0cnVlO1xuXG4gICAgc2VsZi5oZWlnaHQgPSBudWxsO1xuICAgIHNlbGYud2lkdGggPSBudWxsO1xuICAgIHNlbGYubWFyZ2luID0ge1xuICAgICAgICB0b3A6IDIwLFxuICAgICAgICByaWdodDogMTUsXG4gICAgICAgIGJvdHRvbTogMjAsXG4gICAgICAgIGxlZnQ6IDIwXG4gICAgfTtcblxuICAgIChmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICBjb3B5U2FtZVByb3Aoc2VsZiwgY29uZik7XG5cbiAgICAgICAgc2VsZi5pdGVtcyA9IHNlbGYuaXRlbXMgfHwgW107XG4gICAgICAgIHNlbGYubGFuZXMgPSBzZWxmLmxhbmVzIHx8IFtdO1xuICAgICAgICBzZWxmLmxhbmVzLmxlbmd0aCA9IGdldExhbmVMZW5ndGgoKTtcblxuICAgICAgICBpZiAoc2VsZi5oZWlnaHQgPT09IG51bGwpIHNlbGYuaGVpZ2h0ID0gcGFyc2VJbnQoZDMuc2VsZWN0KHNlbGYucmVuZGVyVG8pLnN0eWxlKCdoZWlnaHQnKSkgfHwgNDgwO1xuICAgICAgICBpZiAoc2VsZi53aWR0aCA9PT0gbnVsbCkgc2VsZi53aWR0aCA9IHBhcnNlSW50KGQzLnNlbGVjdChzZWxmLnJlbmRlclRvKS5zdHlsZSgnd2lkdGgnKSkgfHwgNjQwO1xuXG4gICAgICAgIGJ1aWxkKCk7XG4gICAgICAgIGVuYWJsZVpvb20oc2VsZi5pc0VuYWJsZVpvb20pO1xuICAgICAgICBhdXRvcmVzaXplKHNlbGYuaXNBdXRvUmVzaXplKTtcbiAgICAgICAgZW5hYmxlVG9vbHRpcChzZWxmLmlzRW5hYmxlVG9vbHRpcCk7XG4gICAgICAgIHNob3dMYW5lTGFiZWwoc2VsZi5pc0VuYWJsZVRvb2x0aXApO1xuICAgICAgICBzaG93WEdyaWQoc2VsZi5pc1Nob3dYR3JpZCk7XG4gICAgICAgIHNob3dZR3JpZChzZWxmLmlzU2hvd1lHcmlkKTtcbiAgICAgICAgcmVkcmF3KCk7XG4gICAgfSkoKTtcblxuICAgIGZ1bmN0aW9uIGFkZEl0ZW1zKG5ld0l0ZW1zKSB7XG4gICAgICAgIHZhciBpdGVtc1R5cGUgPSB0b1N0ci5jYWxsKG5ld0l0ZW1zKTtcbiAgICAgICAgaWYgKGl0ZW1zVHlwZSAhPT0gYXN0ciAmJiBpdGVtc1R5cGUgIT09IG9zdHIpIHRocm93RXJyb3IoJ0V4cGVjdGVkIG9iamVjdCBvciBhcnJheS4gR290OiAnICsgaXRlbXNUeXBlKTtcbiAgICAgICAgKGl0ZW1zVHlwZSA9PT0gYXN0cikgPyBzZWxmLml0ZW1zID0gc2VsZi5pdGVtcy5jb25jYXQobmV3SXRlbXMpIDogc2VsZi5pdGVtcy5wdXNoKG5ld0l0ZW1zKTtcbiAgICAgICAgb25JdGVtc0NoYW5nZSgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGF1dG9yZXNpemUoaXNBdXRvUmVzaXplKSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHNlbGYuaXNBdXRvUmVzaXplO1xuICAgICAgICBkMy5zZWxlY3Qod2luZG93KS5vbigncmVzaXplJywgKGlzQXV0b1Jlc2l6ZSAhPT0gZmFsc2UpID8gcmVzaXplIDogbnVsbCk7XG4gICAgICAgIHNlbGYuaXNBdXRvUmVzaXplID0gaXNBdXRvUmVzaXplO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkKCkge1xuICAgICAgICB2YXIgbGFuZUxlbmd0aCA9IHNlbGYubGFuZXMubGVuZ3RoLFxuICAgICAgICAgICAgbWFyZ2luV2lkdGggPSBnZXRNYXJnaW5XaWR0aCgpLFxuICAgICAgICAgICAgbWFyZ2luSGVpZ2h0ID0gZ2V0TWFyZ2luSGVpZ2h0KCk7XG5cbiAgICAgICAgY2hhcnQgPSBkMy5zZWxlY3Qoc2VsZi5yZW5kZXJUbylcbiAgICAgICAgICAgIC5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgc2VsZi53aWR0aClcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIHNlbGYuaGVpZ2h0KVxuICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImdhbnR0LWNoYXJ0XCIpO1xuXG4gICAgICAgIGNoYXJ0LmFwcGVuZChcImRlZnNcIikuYXBwZW5kKFwiY2xpcFBhdGhcIilcbiAgICAgICAgICAgIC5hdHRyKFwiaWRcIiwgXCJjbGlwXCIpXG4gICAgICAgICAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBtYXJnaW5XaWR0aClcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIG1hcmdpbkhlaWdodCk7XG5cbiAgICAgICAgbWFpbiA9IGNoYXJ0LmFwcGVuZChcImdcIilcbiAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgc2VsZi5tYXJnaW4ubGVmdCArIFwiLFwiICsgc2VsZi5tYXJnaW4udG9wICsgXCIpXCIpXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIG1hcmdpbldpZHRoKVxuICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgbWFyZ2luSGVpZ2h0KVxuICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm1haW5cIik7XG5cbiAgICAgICAgaXRlbVJlY3RzID0gbWFpbi5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAuYXR0cihcImNsaXAtcGF0aFwiLCBcInVybCgjY2xpcClcIik7XG5cbiAgICAgICAgdG9vbHRpcERpdiA9IGQzLnNlbGVjdChcImJvZHlcIikuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiZ2FudHQtdG9vbHRpcFwiKVxuICAgICAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAwKTtcblxuICAgICAgICB4U2NhbGUgPSBkMy50aW1lLnNjYWxlKClcbiAgICAgICAgICAgIC5kb21haW4oZ2V0VGltZURvbWFpbigpKVxuICAgICAgICAgICAgLnJhbmdlKFswLCBtYXJnaW5XaWR0aF0pO1xuXG4gICAgICAgIHlTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAuZG9tYWluKFswLCBsYW5lTGVuZ3RoXSlcbiAgICAgICAgICAgIC5yYW5nZShbMCwgbWFyZ2luSGVpZ2h0XSk7XG5cbiAgICAgICAgeEF4aXMgPSBkMy5zdmcuYXhpcygpXG4gICAgICAgICAgICAuc2NhbGUoeFNjYWxlKVxuICAgICAgICAgICAgLm9yaWVudCgnYm90dG9tJylcbiAgICAgICAgICAgIC50aWNrcyg1KVxuXG4gICAgICAgIHlBeGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgICAgLnNjYWxlKHlTY2FsZSlcbiAgICAgICAgICAgIC5vcmllbnQoJ2xlZnQnKVxuICAgICAgICAgICAgLnRpY2tzKGxhbmVMZW5ndGgpXG4gICAgICAgICAgICAudGlja0Zvcm1hdChcIlwiKTtcblxuICAgICAgICB6b29tID0gZDMuYmVoYXZpb3Iuem9vbSgpXG4gICAgICAgICAgICAueCh4U2NhbGUpO1xuXG4gICAgICAgIG1haW4uYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIG1hcmdpbkhlaWdodCArICcpJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdtYWluIGF4aXMgZGF0ZScpXG4gICAgICAgICAgICAuY2FsbCh4QXhpcylcblxuICAgICAgICBtYWluLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnbWFpbiBheGlzIGxhbmUnKVxuICAgICAgICAgICAgLmNhbGwoeUF4aXMpO1xuXG4gICAgICAgIG1haW4uYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdsYW5lTGFiZWxzJyk7XG5cbiAgICAgICAgY2hhcnQuY2FsbCh6b29tKTtcblxuICAgICAgICBkMy5zZWxlY3QoJ2h0bWwnKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgIGlmICghc2VsZi5pc0VuYWJsZVRvb2x0aXApIHJldHVybjtcbiAgICAgICAgICAgIGlmICghZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3N2ZyByZWN0JykpIHtcbiAgICAgICAgICAgICAgICBoaWRlVG9vbHRpcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb3B5U2FtZVByb3AoY29weVRvLCBjb3B5RnJvbSkge1xuICAgICAgICB2YXIgcDtcblxuICAgICAgICBmb3IgKHAgaW4gY29weUZyb20pIHtcbiAgICAgICAgICAgIGlmIChjb3B5VG8uaGFzT3duUHJvcGVydHkocCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodG9TdHIuY2FsbChjb3B5RnJvbVtwXSkgPT09IG9zdHIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29weVNhbWVQcm9wKGNvcHlUb1twXSwgY29weUZyb21bcF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29weVRvW3BdID0gY29weUZyb21bcF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZW5hYmxlVG9vbHRpcChpc0VuYWJsZVRvb2x0aXApIHtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gc2VsZi5pc0VuYWJsZVRvb2x0aXA7XG4gICAgICAgIHNlbGYuaXNFbmFibGVUb29sdGlwID0gaXNFbmFibGVUb29sdGlwO1xuICAgICAgICByZWRyYXcoKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlbmFibGVab29tKGlzRW5hYmxlWm9vbSkge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBzZWxmLmlzRW5hYmxlWm9vbTtcbiAgICAgICAgem9vbS5vbihcInpvb21cIiwgKGlzRW5hYmxlWm9vbSkgPyByZWRyYXcgOiBudWxsKTtcbiAgICAgICAgc2VsZi5pc0VuYWJsZVpvb20gPSBpc0VuYWJsZVpvb207XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0TGFuZUxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIChkMy5tYXgoc2VsZi5pdGVtcywgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5sYW5lIH0pICsgMSkgfHwgMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRNYXJnaW5XaWR0aCgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYud2lkdGggLSBzZWxmLm1hcmdpbi5yaWdodCAtIHNlbGYubWFyZ2luLmxlZnQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0TWFyZ2luSGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gc2VsZi5oZWlnaHQgLSBzZWxmLm1hcmdpbi50b3AgLSBzZWxmLm1hcmdpbi5ib3R0b207XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VGltZURvbWFpbigpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIGQzLm1pbihzZWxmLml0ZW1zLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnN0YXJ0IH0pLFxuICAgICAgICAgICAgZDMubWF4KHNlbGYuaXRlbXMsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuZW5kIH0pXG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGlkZVRvb2x0aXAoKSB7XG4gICAgICAgIHRvb2x0aXBEaXYudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAuZHVyYXRpb24oNTAwKVxuICAgICAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAwKVxuICAgICAgICAgICAgLnN0eWxlKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXRlbXMobmV3SXRlbXMpIHtcbiAgICAgICAgdmFyIGl0ZW1zVHlwZSA9IHRvU3RyLmNhbGwobmV3SXRlbXMpO1xuXG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHNlbGYuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtc1R5cGUgIT09IGFzdHIpIHRocm93RXJyb3IoJ0V4cGVjdGVkIGFycmF5LiBHb3Q6ICcgKyBpdGVtc1R5cGUpO1xuICAgICAgICBzZWxmLml0ZW1zID0gbmV3SXRlbXM7XG5cbiAgICAgICAgb25JdGVtc0NoYW5nZSgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxhbmVzKG5ld0xhbmVzKSB7XG4gICAgICAgIHZhciBsYW5lc1R5cGUgPSB0b1N0ci5jYWxsKG5ld0xhbmVzKTtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gc2VsZi5sYW5lcztcbiAgICAgICAgaWYgKGxhbmVzVHlwZSAhPT0gYXN0cikgdGhyb3dFcnJvcignRXhwZWN0ZWQgYXJyYXkuIEdvdDogJyArIGxhbmVzVHlwZSk7XG4gICAgICAgIHNlbGYubGFuZXMgPSBuZXdMYW5lcztcbiAgICAgICAgc2VsZi5sYW5lcy5sZW5ndGggPSBnZXRMYW5lTGVuZ3RoKCkgfHwgc2VsZi5sYW5lcy5sZW5ndGg7XG4gICAgICAgIHNob3dMYW5lTGFiZWwoIXNlbGYuaXNTaG93TGFuZUxhYmVsKTtcbiAgICAgICAgc2hvd0xhbmVMYWJlbCghc2VsZi5pc1Nob3dMYW5lTGFiZWwpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1hcmdpbihuZXdNYXJnaW4pIHtcbiAgICAgICAgdmFyIG1zZyA9IFwiIG1hcmdpbiB2YWx1ZSBpcyBpbmNvcnJlY3QuIEFsbCB2YWx1ZXMgc2hvdWxkIGJlIG51bWJlcnNcIjtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gc2VsZi5tYXJnaW47XG4gICAgICAgIGlmIChuZXdNYXJnaW4udG9wICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmIChpc05hTihuZXdNYXJnaW4udG9wKSkgdGhyb3dFcnJvcihcIidUb3AnXCIgKyBtc2cpO1xuICAgICAgICAgICAgc2VsZi5tYXJnaW4udG9wID0gcGFyc2VJbnQobmV3TWFyZ2luLnRvcCk7XG4gICAgICAgICAgICBtYWluLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBzZWxmLm1hcmdpbi5sZWZ0ICsgXCIsXCIgKyBzZWxmLm1hcmdpbi50b3AgKyBcIilcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld01hcmdpbi5yaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoaXNOYU4obmV3TWFyZ2luLnJpZ2h0KSkgdGhyb3dFcnJvcihcIidSaWdodCdcIiArIG1zZyk7XG4gICAgICAgICAgICBzZWxmLm1hcmdpbi5yaWdodCA9IHBhcnNlSW50KG5ld01hcmdpbi5yaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld01hcmdpbi5ib3R0b20gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKGlzTmFOKG5ld01hcmdpbi5ib3R0b20pKSB0aHJvd0Vycm9yKFwiJ0JvdHRvbSdcIiArIG1zZyk7XG4gICAgICAgICAgICBzZWxmLm1hcmdpbi5ib3R0b20gPSBwYXJzZUludChuZXdNYXJnaW4uYm90dG9tKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3TWFyZ2luLmxlZnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKGlzTmFOKG5ld01hcmdpbi5sZWZ0KSkgdGhyb3dFcnJvcihcIidMZWZ0J1wiICsgbXNnKTtcbiAgICAgICAgICAgIHNlbGYubWFyZ2luLmxlZnQgPSBwYXJzZUludChuZXdNYXJnaW4ubGVmdCk7XG4gICAgICAgICAgICBtYWluLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBzZWxmLm1hcmdpbi5sZWZ0ICsgXCIsXCIgKyBzZWxmLm1hcmdpbi50b3AgKyBcIilcIik7XG4gICAgICAgIH1cblxuICAgICAgICByZXNpemUoKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkl0ZW1zQ2hhbmdlKCkge1xuICAgICAgICB2YXIgbGFuZUxlbmd0aCA9IGdldExhbmVMZW5ndGgoKTtcbiAgICAgICAgc2VsZi5sYW5lcy5sZW5ndGggPSBsYW5lTGVuZ3RoO1xuICAgICAgICB4U2NhbGUuZG9tYWluKGdldFRpbWVEb21haW4oKSk7XG4gICAgICAgIHlBeGlzLnRpY2tzKGxhbmVMZW5ndGgpO1xuICAgICAgICB5U2NhbGUuZG9tYWluKFswLCBsYW5lTGVuZ3RoXSk7XG4gICAgICAgIHpvb20ueCh4U2NhbGUpO1xuICAgICAgICByZWRyYXcoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWRyYXcoKSB7XG4gICAgICAgIHZhciBpdGVtSGVpZ2h0ID0gZ2V0TWFyZ2luSGVpZ2h0KCkgLyAoc2VsZi5sYW5lcy5sZW5ndGggfHwgMSkgLyAoc2VsZi5zdWJsYW5lcyB8fCAxKSxcbiAgICAgICAgICAgIHJlY3RzO1xuXG4gICAgICAgIHJlY3RzID0gaXRlbVJlY3RzLnNlbGVjdEFsbChcInJlY3RcIilcbiAgICAgICAgICAgIC5kYXRhKHNlbGYuaXRlbXMsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkOyB9KVxuICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uIChkKSB7IHJldHVybiB4U2NhbGUoZC5zdGFydCk7IH0pXG4gICAgICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHNlbGYuc3VibGFuZXMgPCAyKSA/IHlTY2FsZShkLmxhbmUpIDogeVNjYWxlKGQubGFuZSkgKyBkLnN1YmxhbmUqaXRlbUhlaWdodDtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIGZ1bmN0aW9uIChkKSB7IHJldHVybiB4U2NhbGUoZC5lbmQpIC0geFNjYWxlKGQuc3RhcnQpOyB9KVxuICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGl0ZW1IZWlnaHQ7IH0pXG4gICAgICAgICAgICAub24oXCJjbGlja1wiLCAoc2VsZi5pc0VuYWJsZVRvb2x0aXApID8gc2hvd1Rvb2x0aXAgOiBudWxsKTtcbiAgICAgICAgcmVjdHMuZW50ZXIoKS5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmNsYXNzICsgJyBtYWluJzsgfSlcbiAgICAgICAgICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4geFNjYWxlKGQuc3RhcnQpOyB9KVxuICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChzZWxmLnN1YmxhbmVzIDwgMikgPyB5U2NhbGUoZC5sYW5lKSA6IHlTY2FsZShkLmxhbmUpICsgZC5zdWJsYW5lKml0ZW1IZWlnaHQ7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4geFNjYWxlKGQuZW5kKSAtIHhTY2FsZShkLnN0YXJ0KTsgfSlcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uIChkKSB7IHJldHVybiAgaXRlbUhlaWdodDsgfSlcbiAgICAgICAgICAgIC5hdHRyKFwib3BhY2l0eVwiLCAuNzUpXG4gICAgICAgICAgICAub24oXCJjbGlja1wiLCAoc2VsZi5pc0VuYWJsZVRvb2x0aXApID8gc2hvd1Rvb2x0aXAgOiBudWxsKTtcbiAgICAgICAgcmVjdHMuZXhpdCgpLnJlbW92ZSgpO1xuXG4gICAgICAgIG1haW4uc2VsZWN0KCdnLm1haW4uYXhpcy5kYXRlJykuY2FsbCh4QXhpcyk7XG4gICAgICAgIG1haW4uc2VsZWN0KCdnLm1haW4uYXhpcy5sYW5lJykuY2FsbCh5QXhpcyk7XG5cbiAgICAgICAgaGlkZVRvb2x0aXAoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNpemUoKSB7XG4gICAgICAgIGlmIChzZWxmLmlzQXV0b1Jlc2l6ZSkge1xuICAgICAgICAgICAgc2VsZi53aWR0aCA9IHBhcnNlSW50KGQzLnNlbGVjdChzZWxmLnJlbmRlclRvKS5zdHlsZSgnd2lkdGgnKSk7XG4gICAgICAgICAgICBzZWxmLmhlaWdodCA9IHBhcnNlSW50KGQzLnNlbGVjdChzZWxmLnJlbmRlclRvKS5zdHlsZSgnaGVpZ2h0JykpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtYXJnaW5XaWR0aCA9IGdldE1hcmdpbldpZHRoKCksXG4gICAgICAgICAgICBtYXJnaW5IZWlnaHQgPSBnZXRNYXJnaW5IZWlnaHQoKTtcblxuICAgICAgICB4U2NhbGUucmFuZ2UoWzAsIG1hcmdpbldpZHRoXSk7XG4gICAgICAgIHlTY2FsZS5yYW5nZShbMCwgbWFyZ2luSGVpZ2h0XSk7XG4gICAgICAgIGNoYXJ0LmF0dHIoXCJ3aWR0aFwiLCBzZWxmLndpZHRoKTtcbiAgICAgICAgY2hhcnQuYXR0cihcImhlaWdodFwiLCBzZWxmLmhlaWdodCk7XG4gICAgICAgIGNoYXJ0LnNlbGVjdCgnZGVmcycpLnNlbGVjdCgnY2xpcFBhdGgnKS5zZWxlY3QoJ3JlY3QnKS5hdHRyKFwid2lkdGhcIiwgbWFyZ2luV2lkdGgpO1xuICAgICAgICBjaGFydC5zZWxlY3QoJ2RlZnMnKS5zZWxlY3QoJ2NsaXBQYXRoJykuc2VsZWN0KCdyZWN0JykuYXR0cihcImhlaWdodFwiLCBtYXJnaW5XaWR0aCk7XG4gICAgICAgIG1haW4uYXR0cihcIndpZHRoXCIsIG1hcmdpbldpZHRoKTtcbiAgICAgICAgbWFpbi5hdHRyKFwiaGVpZ2h0XCIsIG1hcmdpbkhlaWdodCk7XG5cbiAgICAgICAgbWFpbi5zZWxlY3QoJ2cubWFpbi5heGlzLmRhdGUnKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgZ2V0TWFyZ2luSGVpZ2h0KCkgKyAnKScpO1xuXG4gICAgICAgIG1haW4uc2VsZWN0KCdnLmxhbmVMYWJlbHMnKVxuICAgICAgICAgICAgLnNlbGVjdEFsbChcIi5sYW5lVGV4dFwiKVxuICAgICAgICAgICAgLmRhdGEoc2VsZi5sYW5lcylcbiAgICAgICAgICAgIC5hdHRyKFwieVwiLCBmdW5jdGlvbihkLCBpKSB7cmV0dXJuIHlTY2FsZShpICsgLjUpO30pXG5cbiAgICAgICAgem9vbS54KHhTY2FsZSk7XG5cbiAgICAgICAgc2hvd1hHcmlkKHNlbGYuaXNTaG93WUdyaWQpO1xuICAgICAgICBzaG93WUdyaWQoc2VsZi5pc1Nob3dZR3JpZCk7XG5cbiAgICAgICAgcmVkcmF3KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hvd0xhbmVMYWJlbChpc1Nob3dMYW5lTGFiZWwpIHtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gc2VsZi5pc1Nob3dMYW5lTGFiZWw7XG4gICAgICAgIHNlbGYuaXNTaG93TGFuZUxhYmVsID0gaXNTaG93TGFuZUxhYmVsO1xuICAgICAgICBpZiAoaXNTaG93TGFuZUxhYmVsID09PSBmYWxzZSkge1xuICAgICAgICAgICAgbWFpbi5zZWxlY3RBbGwoXCIubGFuZVRleHRcIikucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtYWluLnNlbGVjdCgnZy5sYW5lTGFiZWxzJykuc2VsZWN0QWxsKFwiLmxhbmVUZXh0XCIpXG4gICAgICAgICAgICAgICAgLmRhdGEoc2VsZi5sYW5lcylcbiAgICAgICAgICAgICAgICAuZW50ZXIoKS5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkge3JldHVybiBkO30pXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIC1zZWxmLm1hcmdpbi5yaWdodClcbiAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCwgaSkge3JldHVybiB5U2NhbGUoaSArIC41KTt9KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZHlcIiwgXCIuNWV4XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcInN0YXJ0XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImxhbmVUZXh0XCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaG93VG9vbHRpcChkKSB7XG4gICAgICAgIHRvb2x0aXBEaXYuc3R5bGUoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIilcbiAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgIC5kdXJhdGlvbigyMDApXG4gICAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIC45KTtcbiAgICAgICAgdG9vbHRpcERpdi5odG1sKCh0eXBlb2YgZC50b29sdGlwID09PSAnZnVuY3Rpb24nKSA/IGQudG9vbHRpcCgpIDogZC50b29sdGlwKVxuICAgICAgICAgICAgLnN0eWxlKFwibGVmdFwiLCAoZDMuZXZlbnQucGFnZVgpICsgXCJweFwiKVxuICAgICAgICAgICAgLnN0eWxlKFwidG9wXCIsIChkMy5ldmVudC5wYWdlWSkgKyBcInB4XCIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNob3dYR3JpZChpc1Nob3dYR3JpZCkge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBzZWxmLmlzU2hvd1hHcmlkO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gKGlzU2hvd1hHcmlkICE9PSBmYWxzZSkgPyAtZ2V0TWFyZ2luSGVpZ2h0KCkgOiAtNjtcbiAgICAgICAgeEF4aXMudGlja1NpemUoaGVpZ2h0LCAwLCAwKTtcbiAgICAgICAgc2VsZi5pc1Nob3dYR3JpZCA9IGlzU2hvd1hHcmlkO1xuICAgICAgICBtYWluLnNlbGVjdCgnZy5tYWluLmF4aXMuZGF0ZScpLmNhbGwoeEF4aXMpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNob3dZR3JpZChpc1Nob3dZR3JpZCkge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBzZWxmLmlzU2hvd1lHcmlkO1xuICAgICAgICB2YXIgd2lkdGggPSAoaXNTaG93WUdyaWQgIT09IGZhbHNlKSA/IC1nZXRNYXJnaW5XaWR0aCgpIDogLTY7XG4gICAgICAgIHlBeGlzLnRpY2tTaXplKHdpZHRoLCAwLCAwKTtcbiAgICAgICAgc2VsZi5pc1Nob3dZR3JpZCA9IGlzU2hvd1lHcmlkO1xuICAgICAgICBtYWluLnNlbGVjdCgnZy5tYWluLmF4aXMubGFuZScpLmNhbGwoeUF4aXMpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNpemUod2lkdGgsIGhlaWdodCkge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBbc2VsZi53aWR0aCwgc2VsZi5oZWlnaHRdO1xuICAgICAgICBzZWxmLndpZHRoID0gcGFyc2VJbnQod2lkdGgpIHx8IHNlbGYud2lkdGg7XG4gICAgICAgIHNlbGYuaGVpZ2h0ID0gcGFyc2VJbnQoaGVpZ2h0KSB8fCBzZWxmLmhlaWdodDtcbiAgICAgICAgYXV0b3Jlc2l6ZShmYWxzZSk7XG4gICAgICAgIHJlc2l6ZSgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1YmxhbmVzKG5ld1N1YmxhbmVzKSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHNlbGYuc3VibGFuZXM7XG4gICAgICAgIHNlbGYuc3VibGFuZXMgPSBuZXdTdWJsYW5lcztcbiAgICAgICAgcmVkcmF3KCk7XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdGhyb3dFcnJvcihtc2cpIHtcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKG1zZyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFwaTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
